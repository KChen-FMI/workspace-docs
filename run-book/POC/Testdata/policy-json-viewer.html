<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>ポリシーJSONビューア</title>
  <style>
    :root { --bg:#f6f3ee; --text:#1b1b1b; --accent:#1f5b4a; --muted:#6e6e6e; --card:#ffffff; }
    body { font-family: 'Noto Sans JP', 'Yu Gothic UI', 'Meiryo', sans-serif; background: var(--bg); color: var(--text); margin: 24px; }
    h1 { font-size: 22px; margin: 0 0 6px; }
    .subtitle { color: var(--muted); margin-bottom: 16px; }
    .filters { display: grid; gap: 12px; grid-template-columns: repeat(auto-fit,minmax(220px,1fr)); margin-bottom: 16px; }
    .filter { background: #fff; border: 1px solid #ddd; border-radius: 8px; padding: 12px; }
    label { display:block; font-size: 12px; color: var(--muted); margin-bottom: 6px; }
    input, select { width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 6px; font-size: 14px; }
    .grid { display: grid; gap: 12px; grid-template-columns: repeat(auto-fill,minmax(320px,1fr)); }
    .card { background: var(--card); border: 1px solid #e6e6e6; border-radius: 10px; padding: 12px; }
    .title { font-weight: 600; margin-bottom: 6px情報システム管理規程; }
    .meta { font-size: 12px; color: var(--muted); margin-bottom: 8px; }
    .tag { display: inline-block; font-size: 11px; padding: 2px 6px; border: 1px solid #cbd5d1; border-radius: 999px; margin: 0 6px 6px 0; }
    .section { margin-top: 8px; }
    .section h3 { font-size: 12px; margin: 0 0 4px; color: var(--accent); }
    .section ul { margin: 0; padding-left: 16px; }
    .count { font-size: 12px; color: var(--muted); margin-top: 8px; }
    .hidden { display: none; }
  </style>
</head>
<body>
  <h1>ポリシーJSONビューア</h1>
  <div class="subtitle">POC Testdata の .extracted.json を埋め込み表示</div>
  <div class="filters">
    <div class="filter">
      <label for="textFilter">検索（タイトル/ID/ファイル）</label>
      <input id="textFilter" type="text" placeholder="例: 07-0120">
    </div>
    <div class="filter">
      <label for="docTypeFilter">ドキュメント種別</label>
      <select id="docTypeFilter">
        <option value="">すべて</option>
      </select>
    </div>
  </div>
  <div class="grid" id="cards"></div>
  <div class="count" id="countInfo"></div>
  <script>
    const data = 
[{"doc_id": "01-0080", "title": "", "doc_type": "規程", "effective_dates": [], "revision_history": [], "scope_assets": [], "roles": [], "responsibilities": [], "prohibitions": [], "reporting_triggers": [], "required_actions": [], "evidence_links": ["c:\\CC.Playground\\fmi-projects\\workspace-docs\\FMI-documentation\\company-policy\\01-0080_内部統制システムの基本方針_20240327.pdf"], "_file": "01-0080_内部統制システムの基本方針_20240327.extracted.json"}, {"doc_id": "06-0040", "title": "", "doc_type": "規程", "effective_dates": [], "revision_history": [], "scope_assets": [], "roles": [{"role": "情報システム担当者", "assigned_by": "情報システム管理責任者"}], "responsibilities": [], "prohibitions": [], "reporting_triggers": [], "required_actions": [], "evidence_links": ["c:\\CC.Playground\\fmi-projects\\workspace-docs\\run-book\\POC\\Testdata\\06-0040_財務報告に係る内部統制の構築の基本方針書_20260201.pdf"], "_file": "06-0040_財務報告に係る内部統制の構築の基本方針書_20260201.extracted.json"}, {"doc_id": "06-0050", "title": "", "doc_type": "規程", "effective_dates": [], "revision_history": [], "scope_assets": [], "roles": [{"role": "情報システム担当者", "assigned_by": "情報システム管理責任者"}], "responsibilities": [], "prohibitions": [], "reporting_triggers": [], "required_actions": [], "evidence_links": ["c:\\CC.Playground\\fmi-projects\\workspace-docs\\run-book\\POC\\Testdata\\06-0050_財務報告に係る内部統制の整備･運用及び評価の基本方針書_20121115.pdf"], "_file": "06-0050_財務報告に係る内部統制の整備･運用及び評価の基本方針書_20121115.extracted.json"}, {"doc_id": "06-0060", "title": "", "doc_type": "規程", "effective_dates": [], "revision_history": [], "scope_assets": [], "roles": [], "responsibilities": [], "prohibitions": [], "reporting_triggers": [], "required_actions": [], "evidence_links": ["c:\\CC.Playground\\fmi-projects\\workspace-docs\\run-book\\POC\\Testdata\\06-0060_財務報告に係る内部統制の整備・運用及び評価の基本計画書_202412.pdf"], "_file": "06-0060_財務報告に係る内部統制の整備・運用及び評価の基本計画書_202412.extracted.json"}, {"doc_id": "07-0090", "title": "", "doc_type": "規程", "effective_dates": [], "revision_history": [], "scope_assets": [], "roles": [], "responsibilities": [], "prohibitions": [], "reporting_triggers": [], "required_actions": [], "evidence_links": ["c:\\CC.Playground\\fmi-projects\\workspace-docs\\FMI-documentation\\company-policy\\07-0090_情報セキュリティ基本方針_20130207.pdf"], "_file": "07-0090_情報セキュリティ基本方針_20130207.extracted.json"}, {"doc_id": "07-0120", "title": "情報システム管理規程", "doc_type": "規程", "effective_dates": ["2012-07-01"], "revision_history": [{"date": "2012-07-01", "type": "施行", "note": "1 この規程は、2012年 7月 1日から施行する。"}, {"date": "2013-02-07", "type": "改正施行", "note": "2 この規程は、2013年 2月 7日から改正施行する。"}, {"date": "2018-05-01", "type": "改正施行", "note": "3 この規程は、2018年 5月 1日から改正施行する。"}, {"date": "2025-03-01", "type": "更新", "note": "4 この規程における組織責任者名は組織規程第３条第３項に基づき2025年3月1日より更新"}], "scope_assets": ["サーバー", "ネットワーク機器", "パソコン", "パソコン周辺\n機器", "情報記録媒体", "通信機器", "ミドルウェア", "オペレーティングシステム", "オペレーティ\nングシステムに導入されるソフトウェア", "データベース及びこれらに準ずるもの（以下"], "roles": [{"role": "情報システム管理責任者", "assigned_to": "コーポレート推進部長"}, {"role": "情報システム担当者", "assigned_by": "情報システム管理責任者"}], "responsibilities": ["情報システム機器類の整備及び構築に関する事項", "情報システム機器類の維持及び管理に関する事項", "役職員（当会社の業務に従事する当会社における全ての者をいう。以下同じ。）に対する情", "情報システム機器類の利用によって生じうる情報漏洩の防止に関する事項", "その他情報システム機器類に関する事項"], "prohibitions": ["当会社から貸与されている情報システム機器類以外の情報システム機器類を使用するこ", "当会社から貸与されている情報システム機器類を、利用権限を有しない者に使用させる", "情報システム機器類に不正にアクセスすること", "情報システム機器類の内容を勝手に変更すること", "当会社の情報システム機器類を無断で複製すること", "情報システム機器類を粗略に取り扱い、破損、紛失又は盗難等を生じさせること", "業務上の必要がないにもかかわらず、情報システム機器類を社外へ持ち出すこと", "情報システム機器類のパスワードロック等をせずに離席等をすること", "業務上の必要がない、又は有害なホームページを閲覧、ダウンロード又はプリントアウ", "業務上の必要がない、又は有害な電子メールを使用すること", "業務上の必要がない、又は有害な通話を行うこと", "その他情報システム機器類を不正又は不当に使用すること"], "reporting_triggers": ["情報システム機器類が正常に作動しないとき", "情報システム機器類がウイルスに感染したこと又はその恐れがあることを認識したとき", "情報システム機器類に蓄積されている情報の改ざん又は抹消を認識したとき", "当会社の情報システム機器類の正常な運用を妨げる恐れのある電子メールの着信を認識", "当会社の情報システム機器類を破損又は紛失したとき", "その他当会社の情報システム機器類の正常な運用を妨げる恐れのある事象を認識したと"], "required_actions": ["情報システム機器類に蓄積されている情報を閲覧することができる。"], "evidence_links": ["c:\\CC.Playground\\fmi-projects\\workspace-docs\\run-book\\POC\\Testdata\\07-0120_情報システム管理規程_20250301.pdf"], "_file": "07-0120_情報システム管理規程_20250301.extracted.json"}]
;

    const cards = document.getElementById('cards');
    const textFilter = document.getElementById('textFilter');
    const docTypeFilter = document.getElementById('docTypeFilter');
    const countInfo = document.getElementById('countInfo');
    const docTypes = Array.from(new Set(data.map(d => d.doc_type || ''))).filter(Boolean).sort();
    docTypes.forEach(t => { const opt = document.createElement('option'); opt.value = t; opt.textContent = t; docTypeFilter.appendChild(opt); });
    function render(list) {
      cards.innerHTML = '';
      list.forEach(d => {
        const card = document.createElement('div');
        card.className = 'card';
        const title = d.title || '(無題)';
        const eff = (d.effective_dates || []).join(', ');
        const rev = (d.revision_history || []).length;
        const scope = (d.scope_assets || []).length;
        const roles = (d.roles || []).length;
        const resp = (d.responsibilities || []).length;
        const prohib = (d.prohibitions || []).length;
        const report = (d.reporting_triggers || []).length;
        const actions = (d.required_actions || []).length;
        card.innerHTML = `
          <div class="title">${title}</div>
          <div class="meta">ID: ${d.doc_id || ''} / 種別: ${d.doc_type || ''} / ファイル: ${d._file || ''}</div>
          <div>
            <span class="tag">改定: ${rev}</span>
            <span class="tag">対象資産: ${scope}</span>
            <span class="tag">役割: ${roles}</span>
            <span class="tag">責務: ${resp}</span>
            <span class="tag">禁止: ${prohib}</span>
            <span class="tag">報告: ${report}</span>
            <span class="tag">必須行動: ${actions}</span>
          </div>
          <div class="section">
            <h3>施行日</h3>
            <div>${eff || 'なし'}</div>
          </div>
          <div class="section">
            <h3>対象資産</h3>
            <ul>${(d.scope_assets || []).map(x => `<li>${x}</li>`).join('') || '<li>なし</li>'}</ul>
          </div>
          <div class="section">
            <h3>責務</h3>
            <ul>${(d.responsibilities || []).map(x => `<li>${x}</li>`).join('') || '<li>なし</li>'}</ul>
          </div>
          <div class="section">
            <h3>禁止事項</h3>
            <ul>${(d.prohibitions || []).map(x => `<li>${x}</li>`).join('') || '<li>なし</li>'}</ul>
          </div>
          <div class="section">
            <h3>報告トリガー</h3>
            <ul>${(d.reporting_triggers || []).map(x => `<li>${x}</li>`).join('') || '<li>なし</li>'}</ul>
          </div>
          <div class="section">
            <h3>必須行動</h3>
            <ul>${(d.required_actions || []).map(x => `<li>${x}</li>`).join('') || '<li>なし</li>'}</ul>
          </div>
        `;
        cards.appendChild(card);
      });
      countInfo.textContent = `表示件数: ${list.length} / ${data.length}`;
    }

    function applyFilters() {
      const text = textFilter.value.trim().toLowerCase();
      const docType = docTypeFilter.value;
      const filtered = data.filter(d => {
        const hay = `${d.title || ''} ${d.doc_id || ''} ${d._file || ''}`.toLowerCase();
        const okText = !text || hay.includes(text);
        const okType = !docType || (d.doc_type || '') === docType;
        return okText && okType;
      });
      render(filtered);
    }

    textFilter.addEventListener('input', applyFilters);
    docTypeFilter.addEventListener('change', applyFilters);
    render(data);
  </script>
</body>
</html>